<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Existing head content remains the same until the scripts -->
    
    <!-- Move scripts to the end of body -->
    <script>
        // Add error handling for scripts
        window.onerror = function(message, source, lineno, colno, error) {
            console.error("Error:", message, "at", source, "line", lineno);
            return true; // Prevent default error handling
        };
    </script>
</head>
<body>
    <div id="q-app">
        <div class="q-loading" style="font-size: 30px">
            <div class="q-loading-spinner"></div>
        </div>
    </div>
<!-- Load Vue first -->
    <script src="/vite/js/vue.global.prod.js"></script>
    <script src="/vite/js/vue-router.global.prod.js"></script>
    <script src="/vite/js/quasar.umd.prod.js"></script>
    <script src="/vite/js/axios.min.js"></script>
    
    <!-- Load other scripts -->
    <script src="/vite/js/QCalendarMonth.umd.min.js"></script>
    <script src="/vite/js/Timestamp.umd.min.js"></script>
    
    <!-- Load language files -->
    <script src="/vite/js/en-US.umd.prod.js"></script>
    <script src="/vite/js/fr.umd.prod.js"></script>
    <script src="/vite/js/ar.umd.prod.js"></script>
    
    <!-- Load app scripts -->
    <script src="/vite/js/store.js"></script>
    <script src="/vite/src/layouts/MainLayout.js"></script>
    <script src="/vite/src/pages/PageEntries.js"></script>
    <script src="/vite/src/pages/PageSettings.js"></script>
    
    <!-- Initialize Quasar and main app -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Use the global Quasar object directly
            const app = Vue.createApp({});
            
            // Configure Quasar
            app.use(window.Quasar.default, {
                config: {
                    brand: {
                        primary: '#1976D2',
                        secondary: '#26A69A',
                        accent: '#9C27B0',
                        dark: '#1D1D1D',
                        positive: '#21BA45',
                        negative: '#C10015',
                        info: '#31CCEC',
                        warning: '#F2C037'
                    }
                }
            });
            
            // Configure router
            const router = VueRouter.createRouter({
                history: VueRouter.createWebHashHistory('/vite/'),
                routes: [
                    {
                        path: '/',
                        component: window.MainLayout,
                        children: [
                            { path: '', component: window.PageEntries },
                            { path: 'settings', component: window.PageSettings }
                        ]
                    }
                ]
            });
 
            // Use the router
            app.use(router);
            
            // Mount the app
            app.mount('#q-app');
            
            // Handle app mounted
            const handleAppMounted = () => {
                const loading = document.getElementById('loading');
                const qApp = document.getElementById('q-app');
 
                if (loading) {
                    loading.style.display = 'none';
                }
                if (qApp) {
                    qApp.style.opacity = '1';
                }
                console.log('Application mounted successfully');
            };
 
            // Use nextTick to ensure DOM is updated
            app.config.globalProperties.$nextTick(() => {
                handleAppMounted();
            });
        });
 
        // Global error handler
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('Global error:', { message, source, lineno, colno, error });
            return true; // Prevent default error handler
        };
 
        // Unhandled promise rejections
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
            event.preventDefault();
        });
    </script>
</body>
</html>