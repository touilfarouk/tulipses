<template>
  <div class="relative mt-1" :class="content.wrapper_class">
    <label :for="input_data.name" class="block text-purple-800 text-sm">
      {{ content.label }} <span v-if="content.required" class="text-red-600 text-lg font-bold">*</span>
    </label>
    <input v-model="content.value"
      :type="content.type"
      :name="content.name"
      :id="content.name"
      :placeholder="content.placeholder"
      :maxlength="content.maxlength"
      :minlength="content.minlength"
      :disabled="content.disabled"
      :readonly="content.readonly"
      :required="content.required"
      :autocomplete="content.autocomplete"
      :autofocus="content.autofocus"
      :step="content.step"
      :min="content.min"
      :max="content.max"
      class="w-full px-2.5 py-1 mt-1 text-sm border focus:outline-none bg-white"
      :class="content.error ? 'border-red-500' : 'border-neutral-200'">
    <span v-cloak v-if="content.error" class="text-red-600 text-xs absolute -bottom-4 right-0">{{ content.error_message }}</span>
  </div>
</template>

<script>
import { ref, watch } from 'vue';

export const ed_input = {
  props: ['input_data'],
  emits: ['update_input_data'],
  setup(props, ctx) {
    const content = ref(props.input_data);

    watch(
      () => content.value.value, // Watch the specific key within the object
      (newValue, oldValue) => {
        // Compare the new and old values
        if (newValue != oldValue) {
          delete content.value.error;
          delete content.value.error_message;
          ctx.emit('update_input_data', newValue);
        }
      }
    );

    return {
      content
    };
  }
};
</script>
